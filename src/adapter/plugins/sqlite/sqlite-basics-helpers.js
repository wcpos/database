var e=this&&this.__awaiter||function(e,n,r,t){function o(e){return e instanceof r?e:new r((function(n){n(e)}))}return new(r||(r=Promise))((function(r,i){function u(e){try{s(t.next(e))}catch(e){i(e)}}function c(e){try{s(t.throw(e))}catch(e){i(e)}}function s(e){e.done?r(e.value):o(e.value).then(u,c)}s((t=t.apply(e,n||[])).next())}))},n=this&&this.__generator||function(e,n){var r,t,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(e){return function(n){return s([e,n])}}function s(c){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(u=0)),u;)try{if(r=1,t&&(o=2&c[0]?t.return:c[0]?t.throw||((o=t.return)&&o.call(t),0):t.next)&&!(o=o.call(t,c[1])).done)return o;switch(t=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return u.label++,{value:c[1],done:!1};case 5:u.label++,t=c[1],c=[0];continue;case 7:c=u.ops.pop(),u.trys.pop();continue;default:if(!(o=u.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){u=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){u.label=c[1];break}if(6===c[0]&&u.label<o[1]){u.label=o[1],o=c;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(c);break}o[2]&&u.ops.pop(),u.trys.pop();continue}c=n.call(e,u)}catch(e){c=[6,e],t=0}finally{r=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}},r=new WeakMap;export function getSQLiteBasicsNode(t){var o=r.get(t);return o||(o={open:function(e){return Promise.resolve(new t.Database(e))},run:function(r,t){return e(this,void 0,void 0,(function(){return n(this,(function(e){switch(e.label){case 0:if(!Array.isArray(t.params))throw console.dir(t),new Error("no params array given for query: "+t.query);return[4,execSqlSQLiteNode(r,t,"run")];case 1:return e.sent(),[2]}}))}))},all:function(r,t){return e(this,void 0,void 0,(function(){return n(this,(function(e){switch(e.label){case 0:return[4,execSqlSQLiteNode(r,t,"all")];case 1:return[2,e.sent()]}}))}))},close:function(e){return closeSQLiteDatabaseNode(e)},journalMode:"WAL2"},r.set(t,o)),o}export function execSqlSQLiteNode(e,n,r){var t=!1,o=!1;return new Promise((function(i,u){e[r](n.query,n.params,(function(r,c){if(o)throw new Error("callback called mutliple times "+n.query);o=!0,r?(t&&(console.log("---- ERROR RUNNING SQL:"),console.log(n.query),console.dir(n.params),console.dir(r),console.log("----")),u(r)):(t&&(console.log("execSql() result: "+e.eventNames()),console.log(n.query),console.dir(c),console.log("execSql() result:"),console.log(n.query),console.dir(n.params),console.log("execSql() result -------------------------")),i(c))}))}))}export function closeSQLiteDatabaseNode(e){return new Promise((function(n,r){var t=!1;e.close((function(e){if(t)throw new Error("close() callback called mutliple times");t=!0,e&&!e.message.includes("Database is closed")?r(e):n()}))}))}import{ensureNotFalsy as t}from"rxdb";var o=new WeakMap;export function getSQLiteBasicsCapacitor(i,u){var c=o.get(i);return c||(c={open:function(r){return e(this,void 0,void 0,(function(){var e;return n(this,(function(n){switch(n.label){case 0:return[4,i.createConnection(r,!1,"no-encryption",1)];case 1:return[4,(e=n.sent()).open()];case 2:return n.sent(),[2,e]}}))}))},run:function(r,t){return e(this,void 0,void 0,(function(){return n(this,(function(e){switch(e.label){case 0:return[4,r.run(t.query,t.params,!1)];case 1:return e.sent(),[2]}}))}))},all:function(r,o){return e(this,void 0,void 0,(function(){var e;return n(this,(function(n){switch(n.label){case 0:return[4,r.query(o.query,o.params)];case 1:return e=n.sent(),[2,t(e.values)]}}))}))},close:function(e){return e.close()},journalMode:"android"===u.getPlatform()?"":"WAL"},r.set(i,c)),c}export var EMPTY_FUNCTION=function(){};export function getSQLiteBasicsQuickSQLite(r){var t=this;return{open:function(o){return e(t,void 0,void 0,(function(){return n(this,(function(e){return[2,r({name:o})]}))}))},all:function(r,o){return e(t,void 0,void 0,(function(){return n(this,(function(e){switch(e.label){case 0:return[4,r.executeAsync(o.query,o.params)];case 1:return[2,e.sent().rows._array]}}))}))},run:function(r,o){return e(t,void 0,void 0,(function(){return n(this,(function(e){return[2,r.executeAsync(o.query,o.params)]}))}))},close:function(r){return e(t,void 0,void 0,(function(){return n(this,(function(e){return r.close(EMPTY_FUNCTION,EMPTY_FUNCTION),[2]}))}))},journalMode:""}}export function getSQLiteBasicsExpoSQLite(r,t){var o=this;return void 0===t&&(t=function(e,n){}),{open:function(t){return e(o,void 0,void 0,(function(){return n(this,(function(e){return[2,Promise.resolve(r(t))]}))}))},all:function(r,i){return e(o,void 0,void 0,(function(){return n(this,(function(e){return t("getSQLiteBasicsExpoSQLite.all(): "+i.query),[2,new Promise((function(e,n){r.exec([{sql:i.query,args:i.params}],!1,(function(r,o){if(r)return t("getSQLiteBasicsExpoSQLite.all() ERROR 1 : "+i.query),n(r);if(Array.isArray(o)){var u=o[0];return Object.prototype.hasOwnProperty.call(u,"rows")?(t("getSQLiteBasicsExpoSQLite.all() DONE : "+o),e(u.rows)):(t("getSQLiteBasicsExpoSQLite.all() ERROR 2 : "+i.query),n(u.error))}return n(new Error("getSQLiteBasicsExpoSQLite.all() response is not an array: ".concat(o)))}))}))]}))}))},run:function(r,i){return e(o,void 0,void 0,(function(){return n(this,(function(e){return t("getSQLiteBasicsExpoSQLite.run() : "+i.query),t(JSON.stringify(i.params,null,4)),[2,new Promise((function(e,n){r.exec([{sql:i.query,args:i.params}],!1,(function(r,o){return r?(t("getSQLiteBasicsExpoSQLite.run() ERROR 1 : ",r),n(r)):Array.isArray(o)&&o[0]&&o[0].error?(t("getSQLiteBasicsExpoSQLite.run() ERROR 2 : ",o),n(o)):(t("getSQLiteBasicsExpoSQLite.run() DONE : "+JSON.stringify(o)),void e(o))}))}))]}))}))},close:function(r){return e(o,void 0,void 0,(function(){return n(this,(function(e){return[2,r.closeAsync()]}))}))},journalMode:""}}export function getSQLiteBasicsWebSQL(r,t){var o=this;return void 0===t&&(t=function(e,n){}),{open:function(t){return e(o,void 0,void 0,(function(){return n(this,(function(e){return[2,Promise.resolve(r(t))]}))}))},all:function(r,i){return e(o,void 0,void 0,(function(){return n(this,(function(e){return t("getSQLiteBasicsWebSQL.all(): "+i.query),[2,new Promise((function(e,n){r.transaction((function(r){r.executeSql(i.query,i.params,(function(n,r){var o=Array.from(r.rows);t("getSQLiteBasicsWebSQL.all() DONE: "+o),e(o)}),(function(e){return n(e)}))}))}))]}))}))},run:function(r,i){return e(o,void 0,void 0,(function(){return n(this,(function(e){return t("getSQLiteBasicsWebSQL.run(): "+i.query),[2,new Promise((function(e,n){r.transaction((function(r){r.executeSql(i.query,i.params,(function(n,r){t("getSQLiteBasicsWebSQL.run() DONE: "+i.query),e()}),(function(e){return n(e)}))}))}))]}))}))},close:function(r){return e(o,void 0,void 0,(function(){return n(this,(function(e){return[2,r.closeAsync()]}))}))},journalMode:""}}