var e=this&&this.__awaiter||function(e,n,r,t){function o(e){return e instanceof r?e:new r((function(n){n(e)}))}return new(r||(r=Promise))((function(r,i){function u(e){try{a(t.next(e))}catch(e){i(e)}}function c(e){try{a(t.throw(e))}catch(e){i(e)}}function a(e){e.done?r(e.value):o(e.value).then(u,c)}a((t=t.apply(e,n||[])).next())}))},n=this&&this.__generator||function(e,n){var r,t,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(e){return function(n){return a([e,n])}}function a(i){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,t&&(o=2&i[0]?t.return:i[0]?t.throw||((o=t.return)&&o.call(t),0):t.next)&&!(o=o.call(t,i[1])).done)return o;switch(t=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,t=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!(o=u.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=n.call(e,u)}catch(e){i=[6,e],t=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},r=new WeakMap;export function getSQLiteBasicsNode(t){var o=r.get(t);return o||(o={open:function(e){return Promise.resolve(new t.Database(e))},run:function(r,t){return e(this,void 0,void 0,(function(){return n(this,(function(e){switch(e.label){case 0:if(!Array.isArray(t.params))throw console.dir(t),new Error("no params array given for query: "+t.query);return[4,execSqlSQLiteNode(r,t,"run")];case 1:return e.sent(),[2]}}))}))},all:function(r,t){return e(this,void 0,void 0,(function(){return n(this,(function(e){switch(e.label){case 0:return[4,execSqlSQLiteNode(r,t,"all")];case 1:return[2,e.sent()]}}))}))},close:function(e){return closeSQLiteDatabaseNode(e)},journalMode:"WAL2"},r.set(t,o)),o}export function execSqlSQLiteNode(e,n,r){var t=!1,o=!1;return new Promise((function(i,u){e[r](n.query,n.params,(function(r,c){if(o)throw new Error("callback called mutliple times "+n.query);o=!0,r?(t&&(console.log("---- ERROR RUNNING SQL:"),console.log(n.query),console.dir(n.params),console.dir(r),console.log("----")),u(r)):(t&&(console.log("execSql() result: "+e.eventNames()),console.log(n.query),console.dir(c),console.log("execSql() result:"),console.log(n.query),console.dir(n.params),console.log("execSql() result -------------------------")),i(c))}))}))}export function closeSQLiteDatabaseNode(e){return new Promise((function(n,r){var t=!1;e.close((function(e){if(t)throw new Error("close() callback called mutliple times");t=!0,e&&!e.message.includes("Database is closed")?r(e):n()}))}))}import{ensureNotFalsy as t}from"rxdb";var o=new WeakMap;export function getSQLiteBasicsCapacitor(i,u){var c=o.get(i);return c||(c={open:function(r){return e(this,void 0,void 0,(function(){var e;return n(this,(function(n){switch(n.label){case 0:return[4,i.createConnection(r,!1,"no-encryption",1)];case 1:return[4,(e=n.sent()).open()];case 2:return n.sent(),[2,e]}}))}))},run:function(r,t){return e(this,void 0,void 0,(function(){return n(this,(function(e){switch(e.label){case 0:return[4,r.run(t.query,t.params,!1)];case 1:return e.sent(),[2]}}))}))},all:function(r,o){return e(this,void 0,void 0,(function(){var e;return n(this,(function(n){switch(n.label){case 0:return[4,r.query(o.query,o.params)];case 1:return e=n.sent(),[2,t(e.values)]}}))}))},close:function(e){return e.close()},journalMode:"android"===u.getPlatform()?"":"WAL"},r.set(i,c)),c}export var EMPTY_FUNCTION=function(){};export function getSQLiteBasicsQuickSQLite(r){var t=this;return{open:function(o){return e(t,void 0,void 0,(function(){return n(this,(function(e){return[2,r({name:o},EMPTY_FUNCTION,EMPTY_FUNCTION)]}))}))},all:function(r,o){return e(t,void 0,void 0,(function(){var e;return n(this,(function(n){switch(n.label){case 0:return e=new Promise((function(e){return r.asyncExecuteSql(o.query,o.params,(function(n){var r=n.rows;r&&e(r._array)}),EMPTY_FUNCTION)})),[4,e];case 1:return[2,n.sent()]}}))}))},run:function(r,o){return e(t,void 0,void 0,(function(){return n(this,(function(e){return r.asyncExecuteSql(o.query,o.params,EMPTY_FUNCTION,EMPTY_FUNCTION),[2]}))}))},close:function(r){return e(t,void 0,void 0,(function(){return n(this,(function(e){return r.close(EMPTY_FUNCTION,EMPTY_FUNCTION),[2]}))}))},journalMode:""}}