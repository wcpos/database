import{ensureNotFalsy as t,ensureRxStorageInstanceParamsAreCorrect as e,flatClone as r}from"rxdb";import{RX_STORAGE_NAME_SQLITE as s}from"./sqlite-helpers";import{RxStorageSQLiteStatics as n}from"./sqlite-statics";import{createSQLiteStorageInstance as i}from"./sqlite-storage-instance";export*from"./sqlite-statics";export*from"./sqlite-helpers";export*from"./sqlite-types";export*from"./sqlite-storage-instance";export*from"./sqlite-basics-helpers";export var RxStorageSQLite=function(){function t(t){this.name=s,this.statics=n,this.settings=t}var r=t.prototype;return r.createStorageInstance=function(t){return e(t),i(this,t,this.settings)},r.base64AttachmentToStoredAttachmentsData=function(t){return this.settings.storeAttachmentsAsBase64String?t:Buffer.from(t,"base64")},r.storedAttachmentsDataToBase64=function(t){return this.settings.storeAttachmentsAsBase64String?t:t.toString("base64")},t}();export function getRxStorageSQLite(e){if(e.log){var s=0,n=r=>t(e.log)("## RxStorage SQLite log: "+r);e=r(e);var i=r(e.sqliteBasics),o=i.open;i.open=t=>{var e=s++;return n("open("+e+") "+t),o(t).then((t=>(n("open("+e+") DONE "),t)))};var a=i.all;i.all=(t,e)=>{var r=s++;return n("all("+r+") "+JSON.stringify(e)),a(t,e).then((t=>(n("all("+r+") DONE "),t)))};var l=i.run;i.run=(t,e)=>{var r=s++;return n("run("+r+") "+JSON.stringify(e)),l(t,e).then((t=>(n("run("+r+") DONE "),t)))},e.sqliteBasics=i}return new RxStorageSQLite(e)}