import{flatClone as r}from"rxdb/plugins/utils";import{getRxStorageRemote as t}from"rxdb/plugins/storage-remote";import{Subject as e}from"rxjs";export function getRxStorageSharedWorker(r){var e=getSharedWorkerStateByInput(r.workerInput);return e.statics=r.statics,t(e)}var o=new Map;export function getSharedWorkerStateByInput(t){var a=o.get(t);if(!a){var s=new SharedWorker(t),n=[];s.onerror=r=>{n.push(r)};var p=new e;s.port.onmessage=r=>{var t=r.data;p.next(t)},s.port.start(),a={identifier:"shared-worker",statics:{},messages$:p,send(r){s.port.postMessage(r)}},"string"==typeof t&&o.set(t,a)}return r(a)}