import{flatClone as r}from"rxdb";import{getRxStorageRemote as t}from"rxdb/plugins/storage-remote";import{Subject as e}from"rxjs";export function getRxStorageSharedWorker(r){var e=getWorkerStateByInput(r.workerInput);return e.statics=r.statics,t(e)}var o=new Map;export function getWorkerStateByInput(t){var n=o.get(t);if(!n){var a=new SharedWorker(t),s=[];a.onerror=function(r){s.push(r)};var i=new e;a.port.onmessage=function(r){var t=r.data;i.next(t)},a.port.start(),n={identifier:"shared-worker",statics:{},messages$:i,send:function(r){a.port.postMessage(r)}},"string"==typeof t&&o.set(t,n)}return r(n)}